#include "shifted_logweight_quadrature.hpp"

#include <cassert>
#include <iostream>
#include <utility>
#include <vector>

#include <Eigen/Dense>

/**
 * Vector containing the Chebychev nodes
 */

std::vector<double> epsilons = {
    0.99993831624083029,   0.99944493748098506,   0.99845866686656404,
    0.99698047772758991,   0.99501182885827877,   0.99255466307738693,
    0.98961140531088287,   0.98618496019883828,   0.98227870922889904,
    0.977896507399165,     0.97304267941377265,   0.96772201541493374,
    0.96193976625564337,   0.95570163831772259,   0.94901378788030777,
    0.94188281504434679,   0.93431575721909566,   0.92632008217704609,
    0.91790368068413519,   0.9090748587125117,    0.89984232924354535,
    0.89021520366916485,   0.88020298280001552,   0.86981554748930479,
    0.85906314888159441,   0.8479563982961571,    0.83650625675488666,
    0.82472402416509183,   0.81262132816785271,   0.80021011266294206,
    0.78750262602163934,   0.7745114089990659,    0.7612492823579744,
    0.7477293342162038,    0.73396490713028673,   0.71996958492795748,
    0.70575717930255444,   0.69134171618254492,   0.6767374218896286,
    0.66195870909907473,   0.64702016261615203,   0.63193652498268638,
    0.61672268192795276,   0.60139364767825632,   0.58596455013970472,
    0.57045061596879143,   0.55486715554552268,   0.53922954786392252,
    0.52355322535482129,   0.50785365865591037,   0.49214634134408974,
    0.47644677464517871,   0.46077045213607759,   0.44513284445447737,
    0.42954938403120879,   0.41403544986029517,   0.3986063523217438,
    0.38327731807204724,   0.36806347501731357,   0.35297983738384808,
    0.33804129090092527,   0.32326257811037151,   0.30865828381745525,
    0.29424282069744562,   0.2800304150720424,    0.26603509286971339,
    0.2522706657837962,    0.2387507176420256,    0.22548859100093405,
    0.21249737397836072,   0.19978988733705805,   0.1873786718321474,
    0.17527597583490823,   0.16349374324511329,   0.15204360170384285,
    0.14093685111840565,   0.1301844525106951,    0.11979701719998453,
    0.10978479633083521,   0.10015767075645471,   0.090925141287488354,
    0.082096319315864974,  0.073679917822954022,  0.065684242780904345,
    0.058117184955653267,  0.050986212119692231,  0.044298361682277465,
    0.038060233744356742,  0.032277984585066311,  0.026957320586227351,
    0.02210349260083494,   0.017721290771101017,  0.013815039801161721,
    0.01038859468911707,   0.0074453369226130661, 0.0049881711417212315,
    0.0030195222724102022, 0.0015413331334360181, 0.00055506251901504822,
    6.1683759169706143e-05};

// Number of Chebychev nodes
unsigned num_cheby_nodes = epsilons.size();
// Polynomial degree for interpolation
unsigned k = num_cheby_nodes / 2 - 1;
Eigen::MatrixXd Wcoeffs(num_cheby_nodes, 9);
Eigen::MatrixXd Xcoeffs(num_cheby_nodes, 9);
// Vector of Vectors to store weights and nodes at the Chebychev nodes
std::vector<std::vector<double>> weights(num_cheby_nodes,
                                         std::vector<double>(9));
std::vector<std::vector<double>> nodes(num_cheby_nodes, std::vector<double>(9));

// Dummy function to fill in the values for weights and nodes
void initialize() {
  weights = {{-0.1805798338185136, -0.3958833357605224, -0.5446918087874777,
              -0.5905457961657962, -0.5350061213661019, -0.4170531922571759,
              -0.2825735297241134, -0.1618749321538302, -0.06392496320988975},
             {-0.1806556787353469, -0.396046970697449, -0.5449052437427367,
              -0.5907554625567399, -0.5351752144578688, -0.4171733620366952,
              -0.282651460053895, -0.161919693001035, -0.06394303700926714},
             {-0.1808074953136841, -0.3963743263440001, -0.5453320779995323,
              -0.5911747861031762, -0.5355134325582614, -0.4174136298155829,
              -0.282807096778457, -0.1620089571480324, -0.06397904395414436},
             {-0.1810352138815143, -0.3968654413319171, -0.5459722884456689,
              -0.591803289891905, -0.5360200838695277, -0.4177736416467296,
              -0.2830405517482533, -0.1621430199666738, -0.06403316364799205},
             {-0.1813388237706791, -0.3975201657268485, -0.546825616326252,
              -0.5926408144359228, -0.5366950955476353, -0.4182532243223158,
              -0.2833515399550624, -0.1623216258862239, -0.06410527348649199},
             {-0.1817171944064009, -0.3983367986724957, -0.5478910791554296,
              -0.5936875166721415, -0.5375392660341337, -0.4188531073738671,
              -0.283740354347704, -0.1625447220103473, -0.0641952725341048},
             {-0.1821737010410567, -0.3993207176363436, -0.5491718970318615,
              -0.5949422882020438, -0.5385485691771716, -0.4195690060794791,
              -0.2842040007063334, -0.1628107743874618, -0.06430263877334101},
             {-0.1827060717114015, -0.4004683858260782, -0.5506658561373994,
              -0.5964052764512829, -0.539724613119434, -0.4204026107296456,
              -0.2847435336081332, -0.1631202032178586, -0.0644274645881542},
             {-0.1833149814316616, -0.4017806146525377, -0.5523728173756117,
              -0.5980752698501648, -0.5410659851181503, -0.4213528954289871,
              -0.2853583002361897, -0.1634726090011182, -0.0645695753502278},
             {-0.1839998429585239, -0.4032569409577753, -0.554292948556602,
              -0.5999522644497034, -0.5425719310928936, -0.4224187821724555,
              -0.2860474941369128, -0.1638675906710565, -0.06472883856210644},
             {-0.1847639384541865, -0.4049024232783625, -0.5564290458951859,
              -0.6020350605754443, -0.5442387069953109, -0.4235960618148197,
              -0.2868076596455453, -0.1643029382348215, -0.0649043386622439},
             {-0.1856026662077392, -0.4067095820624546, -0.5587757468297778,
              -0.6043228890120372, -0.5460691091613429, -0.4248887378806248,
              -0.2876422004628483, -0.1647807187382135, -0.06509687152325022},
             {-0.1865212993025991, -0.4086871529406535, -0.5613388723553415,
              -0.6068148563173168, -0.5480571467200781, -0.4262894823255711,
              -0.2885450819085939, -0.1652971679411416, -0.0653049107958083},
             {-0.1875176831415287, -0.4108316005373565, -0.5641156185813593,
              -0.6095098517097594, -0.5502031377714972, -0.4277992946407409,
              -0.2895173288299159, -0.1658529801722935, -0.06552874202555693},
             {-0.1885917072731865, -0.4131425007910894, -0.5671048917302087,
              -0.6124062205774371, -0.5525056110446338, -0.429417244535668,
              -0.2905583629830189, -0.1664477510220699, -0.06576816147724006},
             {-0.1897462609987702, -0.4156251450539071, -0.5703107192243769,
              -0.6155035028411914, -0.554960090071627, -0.4311375639329545,
              -0.2916633721235394, -0.1670785054290591, -0.06602197851770075},
             {-0.19098003104214, -0.4182769227489618, -0.5737301493388494,
              -0.6187996063961717, -0.5575660251491259, -0.4329607360379991,
              -0.2928329520296856, -0.1677455288716288, -0.06629025186907914},
             {-0.1922939810747059, -0.4210993467556827, -0.5773635052554269,
              -0.622292608746331, -0.5603202442885299, -0.4348838354389403,
              -0.2940651058507178, -0.1684477266939412, -0.06657256229213536},
             {-0.1936869386767096, -0.4240911099119492, -0.58121026059805,
              -0.6259820188579192, -0.5632217200107508, -0.4369053924270816,
              -0.2953582705389038, -0.1691838599965455, -0.06686832044545232},
             {-0.1951637466124959, -0.4272593607818938, -0.5852733868969091,
              -0.6298642248660921, -0.5662633962552531, -0.4390187670030244,
              -0.2967079520610296, -0.1699515634486071, -0.06717667208653336},
             {-0.1967202824351603, -0.4305977050472173, -0.5895484154778979,
              -0.633938196310065, -0.5694466820094117, -0.4412259427690871,
              -0.2981154627901337, -0.1707513203056703, -0.0674976936469723},
             {-0.198360819999702, -0.4341130470169211, -0.5940390886423016,
              -0.6382013575035128, -0.572764910344029, -0.4435198178656768,
              -0.2995753579786893, -0.1715798535946274, -0.06783006700512766},
             {-0.2000823532056327, -0.4378004628320346, -0.5987411447814054,
              -0.6426513197976472, -0.5762176946209054, -0.4459012132335692,
              -0.301088657662326, -0.1724378351458872, -0.06817404916223878},
             {-0.2018899463120056, -0.4416679060096322, -0.6036585211125963,
              -0.6472847212884802, -0.5797973262356715, -0.4483622094688902,
              -0.3026493996287943, -0.1733217207144461, -0.06852823018023019},
             {-0.2037807612116424, -0.4457111488844468, -0.608788046886911,
              -0.6520999172441889, -0.5835032720988557, -0.4509026101617747,
              -0.3042572238039066, -0.1742310383076474, -0.06889232584431672},
             {-0.2057575120408074, -0.4499340028484617, -0.614130195773202,
              -0.6570925851733243, -0.5873293037932914, -0.4535171604221077,
              -0.305908775803538, -0.1751640552074591, -0.06926570537509363},
             {-0.2078235666126175, -0.4543419808248731, -0.6196874805395101,
              -0.6622594600479733, -0.5912687742199753, -0.4561990703226555,
              -0.3075987611941861, -0.1761174315326973, -0.06964696781386931},
             {-0.2099739002775795, -0.458926911636024, -0.6254531854253536,
              -0.6675976745505957, -0.5953224566157036, -0.4589506484439926,
              -0.309329190992044, -0.1770922823147692, -0.0700364991064793},
             {-0.2122147324694492, -0.463698542277122, -0.6314316903741191,
              -0.673102162984415, -0.5994800911072353, -0.4617619916120396,
              -0.3110931400610826, -0.1780847996623724, -0.07043286644499994},
             {-0.2145430238683936, -0.4686515322379396, -0.6376174557781268,
              -0.6787691741203047, -0.6037407059173024, -0.4646335926935441,
              -0.3128910152684302, -0.1790949364171121, -0.07083592676511809},
             {-0.2169620065419624, -0.4737909079424401, -0.6440117537317921,
              -0.6845937948923893, -0.6080964805135374, -0.4675583577906706,
              -0.3147179567340581, -0.1801200225437439, -0.0712446679944172},
             {-0.2194725005990901, -0.4791179636919078, -0.6506136403758598,
              -0.6905718252064474, -0.6125422099314497, -0.4705316810953779,
              -0.3165704029504824, -0.1811577142117024, -0.07165807021389906},
             {-0.2220772139503333, -0.4846362441727629, -0.6574221999033023,
              -0.6966969285165338, -0.6170702589022039, -0.4735476232266865,
              -0.3184447177919048, -0.1822061731733538, -0.0720754699354157},
             {-0.224775836249348, -0.4903453257513674, -0.6644350545604326,
              -0.7029642251880787, -0.6216756300318343, -0.4766023808824166,
              -0.3203383026863096, -0.1832637979958006, -0.07249618110637164},
             {-0.2275712882962915, -0.4962490327768582, -0.6716513508893466,
              -0.709367523423876, -0.6263508745204235, -0.4796896546282651,
              -0.3222465633723233, -0.1843277487626406, -0.07291902414338722},
             {-0.2304629647517726, -0.502345695014235, -0.6790662943996817,
              -0.7158998055163649, -0.6310904437020566, -0.48280658545981,
              -0.3241685248310933, -0.185397841941832, -0.07334399005139985},
             {-0.2334522198650682, -0.5086371403876842, -0.6866781091602829,
              -0.7225551954582522, -0.6358877337086739, -0.4859475810592579,
              -0.3260999927930117, -0.1864713988146834, -0.07376993838869765},
             {-0.2365402697445166, -0.5151240755495392, -0.6944825522356332,
              -0.7293256635278641, -0.6407358133809709, -0.48910831773807,
              -0.3280385724420769, -0.1875471839090593, -0.07419639450396334},
             {-0.2397315466354748, -0.5218130583125155, -0.7024799008438508,
              -0.7362034730543455, -0.6456244043206615, -0.492279921730215,
              -0.3299780950239355, -0.18862164500403, -0.07462194882198818},
             {-0.2430271178807722, -0.5287045978322753, -0.7106655763312919,
              -0.743180401682923, -0.6505464340326015, -0.49545774049973,
              -0.3319157822155955, -0.1896932839945595, -0.07504602263792241},
             {-0.2464249904671362, -0.5357943164863133, -0.7190315899338564,
              -0.7502482281862719, -0.6554974401716916, -0.4986403515906611,
              -0.3338513682202376, -0.1907620247834195, -0.075468558077356},
             {-0.2499330695905003, -0.5430933670326935, -0.7275791584364557,
              -0.7573968527372983, -0.6604639224445067, -0.5018160217539351,
              -0.3357766168450007, -0.1918231079815664, -0.07588767805110588},
             {-0.2535486344455835, -0.5505957973419996, -0.7362983798786501,
              -0.7646172673521228, -0.6654418413662436, -0.5049841674584137,
              -0.3376920517921551, -0.1928770184872667, -0.07630357943405376},
             {-0.2572751588751935, -0.5583057146471968, -0.7451855672777966,
              -0.7718995335470504, -0.6704213819392997, -0.5081373399049856,
              -0.3395927541324267, -0.1939209920204545, -0.07671518383171301},
             {-0.261116067726081, -0.5662259947852342, -0.7542343923712966,
              -0.7792319199186192, -0.6753929563881496, -0.5112696023126608,
              -0.34147538032219, -0.1949532368972435, -0.07712177353678241},
             {-0.2650707167369504, -0.5743536093108621, -0.7634357812069937,
              -0.7866046627165577, -0.6803507655926984, -0.514377978261233,
              -0.3433382780021898, -0.1959728499142676, -0.07752299271302886},
             {-0.2691449503031872, -0.5826953673878859, -0.7727853605789671,
              -0.7940053534253001, -0.6852827244836839, -0.5174535137452408,
              -0.345175724027889, -0.196976687075685, -0.07791762660979072},
             {-0.2733361045806758, -0.591243382373817, -0.7822682140395183,
              -0.8014218376728007, -0.6901847796402791, -0.5204970996755593,
              -0.3469898903205196, -0.1979663872318956, -0.07830635990084235},
             {-0.2776538197427076, -0.6000104247037508, -0.7918835532738294,
              -0.8088421473649431, -0.6950422920051617, -0.5234953252266804,
              -0.3487705923512066, -0.198935730950839, -0.07868668073990208},
             {-0.2820967264873033, -0.6089896548521898, -0.8016152334790739,
              -0.8162524407993474, -0.6998499885403934, -0.5264485329832246,
              -0.3505200061971896, -0.199886549636187, -0.079059392659783},
             {-0.2866681147927818, -0.6181822911722967, -0.8114531562555521,
              -0.8236400554524033, -0.7045989569584504, -0.5293509449543854,
              -0.3522345134439375, -0.2008168638222986, -0.07942374202231811},
             {-0.2913697470163856, -0.627586333701611, -0.821384371757447,
              -0.8309924336102601, -0.7092824136493401, -0.5321991009398855,
              -0.3539119505819612, -0.2017252352096494, -0.07977907319471894},
             {-0.2962083059763824, -0.6372062023646964, -0.8313973971327495,
              -0.8382936400754826, -0.7138885468286915, -0.5349858066088738,
              -0.3555485917206284, -0.2026100533992957, -0.08012487702827309},
             {-0.3011842869073917, -0.6470368792454662, -0.8414763225684487,
              -0.8455311367189491, -0.7184119230863454, -0.5377090174363347,
              -0.3571435216772517, -0.2034708322561953, -0.08046095173376795},
             {-0.3063017737831075, -0.6570769592370695, -0.851604811015323,
              -0.8526898412129831, -0.7228445157976614, -0.5403651065234933,
              -0.3586951717882073, -0.2043068851688392, -0.08078704987104075},
             {-0.3115654110082577, -0.6673263864616851, -0.8617684528481835,
              -0.8597563369911835, -0.7271779711790461, -0.5429485782038103,
              -0.3601998905363384, -0.205116092367439, -0.08110233182742582},
             {-0.316976564143609, -0.6777775927461174, -0.8719459137375919,
              -0.8667160156250558, -0.7314073840189345, -0.5454592741344859,
              -0.3616589003521818, -0.2058995198254566, -0.08140726674188657},
             {-0.3225449642313378, -0.6884351808287535, -0.8821226276562935,
              -0.873553503717236, -0.7355214727248192, -0.547888930337423,
              -0.3630666103252958, -0.2066539881523564, -0.0817006233221468},
             {-0.3282665353881416, -0.699281725123582, -0.8922721064805496,
              -0.8802572238657139, -0.739520897386003, -0.550242238246252,
              -0.3644274903307318, -0.2073823212595703, -0.08198352494107007},
             {-0.3341517841208389, -0.7103205974788598, -0.9023785830807658,
              -0.8868128712581077, -0.7433950483653281, -0.5525107697063031,
              -0.3657354236946083, -0.2080809012060898, -0.08225455358862276},
             {-0.3402042741537049, -0.7215418824261299, -0.912417122126926,
              -0.8932062598745454, -0.747139468062568, -0.5546944591778945,
              -0.3669917475800168, -0.2087509363862546, -0.08251425384164661},
             {-0.3464300906534018, -0.7329382083123649, -0.9223650125012132,
              -0.8994245943439687, -0.7507487586462198, -0.556790658583009,
              -0.3681949825931291, -0.2093916612325501, -0.08276234859006942},
             {-0.352830513354469, -0.7444938304360856, -0.9321966559031374,
              -0.9054583792625677, -0.7542222677795464, -0.5588005598927929,
              -0.3693459873543034, -0.2100034127477722, -0.08299891615987912},
             {-0.3594128747072069, -0.7561985488635208, -0.941887345193313,
              -0.9112949762420203, -0.7575548073126688, -0.5607221101819957,
              -0.3704441582647897, -0.2105861458796207, -0.0832240040975313},
             {-0.3661837168842866, -0.7680387654147909, -0.9514118551497772,
              -0.916923781845466, -0.7607429149583446, -0.5625540324708244,
              -0.3714890046432741, -0.2111397114763964, -0.08343758800323849},
             {-0.3731473365718705, -0.779995795635752, -0.9607445428464176,
              -0.9223368426576781, -0.7637855371290427, -0.5642965325363581,
              -0.3724807444099129, -0.2116642315584897, -0.08363971872013236},
             {-0.3803079061825849, -0.7920468308227154, -0.9698575956287289,
              -0.9275262118359805, -0.7666828420451229, -0.5659517084764476,
              -0.3734213146638675, -0.2121609081177566, -0.08383087515993949},
             {-0.3876770123590784, -0.8041769675588726, -0.9787288180062405,
              -0.9324832786315809, -0.7694296462087008, -0.5675154031911657,
              -0.3743078319036619, -0.2126281673472441, -0.08401048145831293},
             {-0.3952525471769671, -0.8163483168713616, -0.9873275738393694,
              -0.937204872772619, -0.7720325175034666, -0.5689954403638241,
              -0.3751463287263004, -0.2130695862803089, -0.08417994474147407},
             {-0.4030488622700072, -0.8285439334217951, -0.9956362196417393,
              -0.9416851416385976, -0.774485431330467, -0.570385303122637,
              -0.3759316036061158, -0.21348202697065, -0.08433803150709009},
             {-0.4110634463679045, -0.8407184835447887, -1.003625996707136,
              -0.9459234956075782, -0.77679642603604, -0.5716938030841807,
              -0.3766704000338169, -0.213869542122607, -0.08448636577804249},
             {-0.4193084284874231, -0.8528439514396188, -1.011279208412314,
              -0.9499162923871673, -0.7789624493493522, -0.5729177851068132,
              -0.3773603890378647, -0.2142308307211971, -0.0846244603963469},
             {-0.4277862751264804, -0.8648761126479136, -1.018575809576602,
              -0.9536651321848169, -0.7809883991053888, -0.574061223046002,
              -0.3780040503888269, -0.2145671819531534, -0.08475279276356093},
             {-0.4365027836126529, -0.876771565156378, -1.025498893590727,
              -0.9571705693101338, -0.7828766266398154, -0.5751261327198868,
              -0.3786029401042849, -0.2148796390926771, -0.08487182702649661},
             {-0.4454573954123475, -0.8884776303097036, -1.032034378609749,
              -0.9604382543867129, -0.7846339491148355, -0.5761171862573599,
              -0.3791596700369311, -0.2151694556509532, -0.084982002408414},
             {-0.4546600351702025, -0.8999516017131763, -1.038173224666567,
              -0.9634683602961953, -0.7862589988642519, -0.5770329049672713,
              -0.3796735805139834, -0.2154365756363746, -0.08508340039199745},
             {-0.4641047893301244, -0.9111317078988758, -1.043906636991214,
              -0.9662698330747974, -0.7877612613235047, -0.5778801600878685,
              -0.3801487734978775, -0.2156830513365561, -0.08517675249438549},
             {-0.4737940590884417, -0.9219669368732497, -1.049232790596309,
              -0.9688479199789127, -0.7891427467950852, -0.5786591262512063,
              -0.3805850214975645, -0.2159087647251459, -0.08526204675152342},
             {-0.4837201161558061, -0.9323963674697594, -1.054150258631957,
              -0.9712113022256905, -0.790410906573161, -0.5793752085815987,
              -0.3809858275980439, -0.2161156603093083, -0.08534003456002794},
             {-0.4938717861092639, -0.9423606757265326, -1.058662222036885,
              -0.9733694081450317, -0.7915725132756622, -0.5800329467353532,
              -0.3813541400577408, -0.2163054480658517, -0.08541140604915087},
             {-0.504238539879231, -0.9518090488138848, -1.06277775069064,
              -0.9753307868373974, -0.7926308934215996, -0.5806330461518349,
              -0.3816898426448155, -0.2164779634930045, -0.08547610380564527},
             {-0.5147986441004316, -0.9606886262011958, -1.066507273610765,
              -0.9771059279914559, -0.7935925725858224, -0.5811795748092872,
              -0.3819954127670631, -0.2166345513463565, -0.08553464379254914},
             {-0.5255217946890818, -0.9689515514609942, -1.069864237493205,
              -0.9787060753301927, -0.7944644713599546, -0.5816768369704844,
              -0.3822735281287998, -0.2167767639924029, -0.08558766727025958},
             {-0.5363681030436321, -0.9765580363302658, -1.072865139917273,
              -0.9801428141353198, -0.7952534479129513, -0.582129082670959,
              -0.3825267928830294, -0.2169060197897807, -0.08563571473386158},
             {-0.5472879551178214, -0.9834809914466828, -1.075531197578121,
              -0.9814285918242459, -0.7959652506380456, -0.5825384972329762,
              -0.3827558048706921, -0.2170224190423912, -0.0856788006956925},
             {-0.5582170692329528, -0.9897025897656635, -1.077883196610593,
              -0.9825750397515449, -0.7966067130846481, -0.5829096523033187,
              -0.3829636086823572, -0.2171277213800193, -0.08571761966802716},
             {-0.5690818316733692, -0.995225254092268, -1.079947219477777,
              -0.983593266932749, -0.7971810993849872, -0.5832428035012729,
              -0.3831498297633671, -0.2172217129651329, -0.08575213054493812},
             {-0.5797802285523432, -1.000052393480312, -1.081745571637264,
              -0.9844981435430353, -0.7977001909019223, -0.5835470870999756,
              -0.3833207027493152, -0.2173079350934938, -0.0857837069517161},
             {-0.5902075680661754, -1.00421693858179, -1.083307409404317,
              -0.9853017226347153, -0.7981680732499039, -0.5838231006094105,
              -0.3834756045044705, -0.2173856771426472, -0.0858120018421789},
             {-0.600240872486383, -1.007762117077093, -1.084660372407295,
              -0.9860162420252732, -0.7985909139818833, -0.5840744695165458,
              -0.3836168791829379, -0.2174563823421664, -0.08583763198012095},
             {-0.6097465852864921, -1.010745814582729, -1.085833973186652,
              -0.9866543350157195, -0.7989741534473942, -0.5843035602771328,
              -0.3837456739891099, -0.2175206451029628, -0.0858608301066634},
             {-0.618578312044799, -1.013228267109872, -1.086853547913277,
              -0.987229847887314, -0.7993279305973264, -0.5845176654471795,
              -0.3838665275893768, -0.2175808358489979, -0.08588247243024882},
             {-0.6266030987617114, -1.015289372742965, -1.08774881360588,
              -0.9877519331035073, -0.7996527871545563, -0.5847146067464101,
              -0.3839773088169364, -0.2176356715894846, -0.08590207058197202},
             {-0.6336855204083253, -1.016994972888928, -1.088540060635322,
              -0.9882307481844641, -0.7999564680671912, -0.584900521568594,
              -0.3840822656748263, -0.2176875718053621, -0.08592056296599801},
             {-0.6397165742454255, -1.018411151900122, -1.089246575150717,
              -0.9886729554382451, -0.8002408700537966, -0.5850754982777696,
              -0.3841810965376397, -0.2177363468876728, -0.08593789593426608},
             {-0.6446212620236056, -1.019589374622204, -1.089877707037709,
              -0.9890796058017897, -0.8005057449827992, -0.5852393867720687,
              -0.384273828063464, -0.2177820768030993, -0.0859541167406614},
             {-0.6483688316084547, -1.020559942173062, -1.090433021689474,
              -0.9894469577914443, -0.8007480680484389, -0.5853902874299304,
              -0.3843594366720209, -0.2178242948414243, -0.08596907326134899},
             {-0.6509955075330501, -1.021336746744884, -1.090901000264277,
              -0.989760204368898, -0.8009547888574002, -0.5855186389803174,
              -0.3844319644512975, -0.2178599114153887, -0.08598164813785324},
             {-0.6525916039749501, -1.021896788127096, -1.091252499429839,
              -0.9899987532944808, -0.8011133386283669, -0.585617593186547,
              -0.3844881537602865, -0.2178876355301909, -0.08599147153172651},
             {-0.6533113749764091, -1.022200917143974, -1.091448340549018,
              -0.990132468469034, -0.8012023470098397, -0.5856730177707119,
              -0.3845194276422073, -0.217902934263744, -0.08599685258116149}};

  nodes = {{0.03075245869478716, 0.1580504067330983, 0.3721098843237418,
            0.6511744478664365, 0.9682806415468314, 1.29203061135612,
            1.588179110019359, 1.822614548685483, 1.965175968380464},
           {0.03075220751382179, 0.1580489930476272, 0.3721065090840432,
            0.6511695077629951, 0.9682757503279491, 1.292027180817604,
            1.588177475884411, 1.822614122451327, 1.965175937501457},
           {0.03075172345932042, 0.1580462171202113, 0.3720997982906156,
            0.6511596686889705, 0.9682661019540102, 1.292020597050414,
            1.588174545043066, 1.822613504511784, 1.96517593554683},
           {0.03075097973219299, 0.1580419949055258, 0.3720896405874743,
            0.6511447139900186, 0.9682512005135092, 1.292010056376288,
            1.58816945975451, 1.822612141584467, 1.965175826542912},
           {0.03074995883915555, 0.1580362110135307, 0.3720757478631871,
            0.6511242527448489, 0.9682307394069212, 1.291995445164262,
            1.58816224353101, 1.822610079207462, 1.96517562361417},
           {0.03074843810878591, 0.158027883753656, 0.3720563517403459,
            0.6510961676596871, 0.9682028226830275, 1.291975488269098,
            1.588152304480297, 1.822607166129489, 1.965175315301525},
           {0.03074697955619787, 0.1580195221331089, 0.3720360881214007,
            0.6510662551022663, 0.9681730162185523, 1.291954411249012,
            1.588142114310849, 1.822604403853582, 1.965175083625915},
           {0.03074514856573885, 0.1580091885172152, 0.3720113965524683,
            0.6510301142877071, 0.9681371425451186, 1.29192904416184,
            1.588129784527181, 1.822600998566069, 1.965174778447091},
           {0.03074302514014971, 0.1579971746921127, 0.3719826180088302,
            0.650987871567229, 0.9680950335990405, 1.291899070791388,
            1.588115044048656, 1.822596811523527, 1.965174370342897},
           {0.03074045482590226, 0.1579828816529794, 0.3719488999324194,
            0.6509387946107177, 0.9680461916866087, 1.291864081878844,
            1.58809749387055, 1.822591566600885, 1.965173787575077},
           {0.03073795442740779, 0.1579685709869783, 0.3719143312215343,
            0.6508880013640206, 0.9679957937357564, 1.291828507377873,
            1.588080232169939, 1.822586800265744, 1.965173358323923},
           {0.03073467309845035, 0.1579503895130008, 0.3718716020244879,
            0.6508259410170629, 0.9679339552414427, 1.291783910206733,
            1.588057478805851, 1.822579712637426, 1.965172493493485},
           {0.03073144858758803, 0.1579321447149613, 0.3718279879338806,
            0.6507622294228677, 0.9678707458284849, 1.291738957862419,
            1.58803520699344, 1.822573212260578, 1.965171807419291},
           {0.03072784044200261, 0.1579118273944216, 0.3717796465353129,
            0.65069181667111, 0.9678008955193939, 1.291689066604502,
            1.588010172506645, 1.822565663430474, 1.96517094474152},
           {0.0307237574467194, 0.157888961906026, 0.3717254996022188,
            0.6506130592272927, 0.9677225140351269, 1.291632543195579,
            1.587981221924181, 1.82255652921267, 1.96516979705196},
           {0.03071959591685447, 0.157865452234417, 0.3716694923245956,
            0.6505316264829037, 0.9676419317154508, 1.291575015528548,
            1.587952239684757, 1.822547667530714, 1.965168749052362},
           {0.03071505002897035, 0.1578398028317056, 0.3716084910830138,
            0.6504430567606092, 0.9675542773944089, 1.291512261200741,
            1.587920378251496, 1.822537739297472, 1.965167525744708},
           {0.0307101853569014, 0.1578122888285998, 0.3715429588170036,
            0.6503478623268544, 0.9674599225281094, 1.291444376285527,
            1.587885510704829, 1.822526592051871, 1.965166081905882},
           {0.03070470135014536, 0.1577816645533892, 0.371470887667283,
            0.6502440112434702, 0.9673574340639282, 1.291370701118903,
            1.587847536250705, 1.822514313204305, 1.965164453433172},
           {0.03069929219750778, 0.1577509083007067, 0.3713974709911894,
            0.650137620664355, 0.9672523739089705, 1.291295242026992,
            1.587808667227268, 1.822501743016548, 1.96516278465704},
           {0.03069316634682795, 0.1577164952949526, 0.3713162253692022,
            0.6500206166598097, 0.9671369311805805, 1.291211890197523,
            1.587765120734536, 1.822487216788421, 1.965160747390553},
           {0.03068689572782968, 0.1576809964308668, 0.3712319985632711,
            0.649899332278951, 0.9670176329803953, 1.291126123877415,
            1.587720557576041, 1.822472470025652, 1.965158702586988},
           {0.03067987223483071, 0.1576416495688102, 0.3711395376118951,
            0.6497669044677896, 0.96688736485884, 1.29103183091139,
            1.587670738459331, 1.822455412806209, 1.965156203452524},
           {0.03067277054607787, 0.1576014490073172, 0.3710443852402634,
            0.6496304338216716, 0.9667533195678738, 1.290934970172959,
            1.587619605705051, 1.822437894797671, 1.965153630940104},
           {0.03066499704659398, 0.1575577845544249, 0.370941860031174,
            0.6494843169325679, 0.9666103313287802, 1.290831691886077,
            1.587564872235184, 1.82241894068521, 1.965150796557534},
           {0.03065683732921687, 0.15751183383514, 0.3708339005161785,
            0.6493306819573605, 0.9664601081339549, 1.290722936437988,
            1.587506797579771, 1.822398506875955, 1.965147667047306},
           {0.03064864958636115, 0.157465236117492, 0.3707237135237296,
            0.6491739504388285, 0.966307488403107, 1.290613040310867,
            1.587448498960203, 1.822378177349243, 1.965144587688233},
           {0.0306395038286198, 0.1574137924144052, 0.370603403836254,
            0.6490040055306738, 0.9661423090470833, 1.290493644850168,
            1.587384453163761, 1.82235534283026, 1.965141015655111},
           {0.03063017945196211, 0.15736098245658, 0.370479475856663,
            0.6488292055798739, 0.9659728646906862, 1.290371275914943,
            1.587318660028194, 1.822331732355767, 1.965137286421345},
           {0.03062004904569249, 0.1573039114651536, 0.3703463541487213,
            0.6486423275437903, 0.9657919889795643, 1.290240298378222,
            1.587247674793731, 1.822305863197008, 1.9651331131709},
           {0.03060941471111911, 0.1572439380666799, 0.3702066525610281,
            0.6484468861902783, 0.9656032722442576, 1.290103521523456,
            1.58717314744615, 1.822278399381445, 1.965128616038151},
           {0.03059820559409765, 0.1571807731264523, 0.370059991731315,
            0.6482427802454274, 0.9654070980388523, 1.289961710955869,
            1.58709589828497, 1.822249860685101, 1.965123920881941},
           {0.03058662032750603, 0.1571152092659458, 0.3699076512957722,
            0.6480314293681761, 0.9652045728080035, 1.28981536421823,
            1.587015910799448, 1.822220077458109, 1.965118968934151},
           {0.03057440274303747, 0.1570461619894865, 0.3697478408094503,
            0.6478109408846002, 0.9649941343021002, 1.289663402988678,
            1.586932587539372, 1.82218881607541, 1.965113718749966},
           {0.03056175676575212, 0.1569744554130415, 0.3695820015902886,
            0.6475832746813093, 0.96477802943159, 1.289507984714565,
            1.586847575915245, 1.822156940432524, 1.965108359946838},
           {0.03054837760261586, 0.1568986737739055, 0.3694073885911493,
            0.6473447306609199, 0.9645520953529474, 1.289345099278753,
            1.586757777169684, 1.82212280112071, 1.965102525808633},
           {0.03053422608032075, 0.1568186671986447, 0.3692239507204194,
            0.6470957989783601, 0.9643174707030258, 1.289176226390121,
            1.586664514317392, 1.82208715810592, 1.965096391592557},
           {0.03051924197024625, 0.1567340566876587, 0.3690307804061992,
            0.646835125102788, 0.9640725369423542, 1.288999788866464,
            1.586566592480556, 1.822049385773706, 1.965089818520934},
           {0.03050377117438496, 0.1566464384672852, 0.3688311429061015,
            0.6465674328338644, 0.9638224751969728, 1.288820243392685,
            1.586467009153586, 1.82201090948505, 1.96508310424129},
           {0.03048769647922667, 0.1565552237065502, 0.3686239336949679,
            0.6462914574819123, 0.9635660958035761, 1.288636594785349,
            1.586365055508332, 1.821971356841524, 1.965076164077424},
           {0.03047049991136874, 0.1564580420877177, 0.3684047122394205,
            0.6460015635049656, 0.9632976776567901, 1.28844405783604,
            1.586257542026658, 1.821929225029242, 1.965068687835585},
           {0.03045292744202333, 0.15635821108023, 0.3681798603820581,
            0.6457064122467548, 0.9630263497455225, 1.288250380914252,
            1.586149693308238, 1.821887010255979, 1.965061196945407},
           {0.03043434772662623, 0.1562528356580155, 0.3679439651382119,
            0.6453991362383993, 0.9627451064378214, 1.288049633245469,
            1.586037472762213, 1.821842759615517, 1.965053279397104},
           {0.03041490410300063, 0.1561425842730431, 0.3676985866250768,
            0.645082308401923, 0.9624569458030385, 1.287844469528655,
            1.58592268205741, 1.821797321085126, 1.965045109218494},
           {0.03039471782146896, 0.156027882227612, 0.3674444516324475,
            0.6447568511335318, 0.9621625962180445, 1.287635282660363,
            1.585805506062003, 1.821750784712263, 1.965036708901042},
           {0.03037339673490269, 0.1559069625971974, 0.3671785314879659,
            0.6444194278895397, 0.9618591289261746, 1.287419925194493,
            1.585684628457324, 1.821702540319914, 1.965027950040498},
           {0.03035131223213528, 0.1557814939318243, 0.3669042681539443,
            0.644074947943563, 0.9615516751340267, 1.28720261096759,
            1.58556279294089, 1.821653865000586, 1.96501909558757},
           {0.03032782598408312, 0.1556484442854014, 0.3666158067979306,
            0.6437155858159895, 0.9612317241521733, 1.286975741048319,
            1.585434638183564, 1.821602116982622, 1.965009584956961},
           {0.03030369655992393, 0.1555113389968386, 0.3663205899598843,
            0.643352347880453, 0.9609117475722058, 1.286750661704348,
            1.585308277175958, 1.821551331100944, 1.965000278553627},
           {0.03027840530614379, 0.1553676733758249, 0.3660137646184729,
            0.6429785556133822, 0.9605840686109404, 1.286520121346991,
            1.585178358460353, 1.821498792342088, 1.964990591752688},
           {0.03025194499551409, 0.1552174316411865, 0.3656958293175763,
            0.642595581334525, 0.9602505043326506, 1.286285843205413,
            1.585046093987761, 1.821445071994958, 1.964980640073821},
           {0.03022412525496776, 0.1550597318275722, 0.3653655811036298,
            0.6422024889598879, 0.9599105374141872, 1.286047827321942,
            1.584911840982156, 1.821390508085713, 1.964970518087616},
           {0.03019526830204544, 0.1548959372995349, 0.3650258793815697,
            0.6418030887778912, 0.9595675654275355, 1.285808271849136,
            1.584776607839577, 1.821335389963518, 1.964960260884444},
           {0.03016500197372141, 0.1547244040199647, 0.36467429897009,
            0.6413949519950619, 0.959219482210147, 1.285565664793626,
            1.584639521159612, 1.821279347727608, 1.964949796524604},
           {0.03013332826217652, 0.1545450277206661, 0.364310977109563,
            0.640978363548353, 0.9588662752636914, 1.28531973689799,
            1.584500290381267, 1.821222219589092, 1.964939089893351},
           {0.03010026734056259, 0.154357989751563, 0.3639372197686404,
            0.640555960656666, 0.9585111583414612, 1.28507351039023,
            1.584361116185573, 1.821165107761145, 1.964928376172063},
           {0.03006549824504967, 0.1541617504670523, 0.3635505419599772,
            0.6401244370683405, 0.9581501730264499, 1.284823178031106,
            1.584219185218557, 1.821106591924572, 1.964917351183285},
           {0.03002949640038688, 0.153958457045148, 0.3631558816815927,
            0.639690832698959, 0.9577907323303712, 1.284575084339626,
            1.584078824914786, 1.821048751605344, 1.964906449420787},
           {0.02999136190146823, 0.1537441051838062, 0.3627465077206291,
            0.6392465927494551, 0.9574237887761123, 1.284321401103947,
            1.583934669765451, 1.820989006640377, 1.964895132397739},
           {0.02995158230332762, 0.153520987756282, 0.3623279692126205,
            0.638799753788492, 0.9570580324884008, 1.284069791298155,
            1.583792075437529, 1.820929967475367, 1.964883948223024},
           {0.02990994960831817, 0.1532881564894568, 0.3618992391821347,
            0.638348709097643, 0.9566909868858777, 1.283817476364614,
            1.583648791157335, 1.820870442549958, 1.96487263711043},
           {0.02986645708605007, 0.1530456806246445, 0.361461603316245,
            0.637895394897326, 0.9563245506533469, 1.283566035214944,
            1.58350588552146, 1.820810939324002, 1.964861303379994},
           {0.02982063420819081, 0.1527916697486349, 0.3610129222264651,
            0.6374375338681004, 0.9559566859575677, 1.28331412863945,
            1.583362738694975, 1.820751278837038, 1.964849925190158},
           {0.02977253528596591, 0.1525265183763556, 0.3605551026595311,
            0.636977363287702, 0.9555890389040642, 1.283062641405635,
            1.583219672751954, 1.820691522982821, 1.964838505090828},
           {0.02972210216111604, 0.1522502145678262, 0.3600894831000034,
            0.6365165594564393, 0.9552230292074244, 1.282812600120157,
            1.58307729714869, 1.820631932846456, 1.964827093582246},
           {0.02966904759368916, 0.1519618959305409, 0.3596160953993928,
            0.636055341584203, 0.9548589155915794, 1.282564332131059,
            1.582935906940912, 1.820572673486412, 1.964815727715832},
           {0.02961306059170443, 0.1516605663728536, 0.3591343818652215,
            0.6355924769415902, 0.9544948875244046, 1.282316067502682,
            1.582794248685004, 1.820513145943336, 1.964804284110545},
           {0.02955439564261075, 0.1513479692042075, 0.3586493114644351,
            0.6351342795280837, 0.9541372001802344, 1.282072940252119,
            1.582655696465663, 1.820454924008079, 1.964793085761706},
           {0.02949217961507533, 0.1510208678218952, 0.3581560228746374,
            0.6346735752957071, 0.9537778604526381, 1.281827970147836,
            1.582515482638903, 1.820395726336548, 1.964781657917672},
           {0.02942680931512087, 0.1506820887620655, 0.3576618443079467,
            0.6342200643206617, 0.9534270935986515, 1.281590013965311,
            1.582379705207233, 1.820338507165175, 1.964770621494723},
           {0.02935735718987909, 0.1503285320579766, 0.3571619356551419,
            0.6337662282686789, 0.9530763797524917, 1.28135152524401,
            1.582243126461574, 1.820280714565935, 1.964759437623595},
           {0.02928399259907466, 0.1499624017003414, 0.356661879715243,
            0.6333187065258592, 0.9527321847329668, 1.281117754507862,
            1.582109190112982, 1.820223969858192, 1.96474844328351},
           {0.02920613956977247, 0.1495828799963712, 0.3561612316029021,
            0.6328761625881687, 0.9523929771308539, 1.280887527572392,
            1.581977237152479, 1.820168018350305, 1.964737593453704},
           {0.02912347069760557, 0.1491905897003807, 0.3556618519607502,
            0.6324398432015439, 0.9520593899086087, 1.280661007439433,
            1.58184717877779, 1.820112742328459, 1.964726853346578},
           {0.02903521533035747, 0.1487847290196018, 0.3551628700941512,
            0.632007988763835, 0.9517297797969244, 1.280437163649681,
            1.58171856912045, 1.820058026934639, 1.964716212207228},
           {0.02894135985456847, 0.1483682886059865, 0.354669869836775,
            0.6315863930514101, 0.9514090993592514, 1.280219424168299,
            1.581593281431493, 1.820004606718927, 1.964705803149428},
           {0.02884084250159025, 0.1479402544543169, 0.3541805678169359,
            0.6311712441223172, 0.9510935590896978, 1.280004975731545,
            1.581469715794273, 1.819951842586726, 1.964695509999212},
           {0.0287332412263841, 0.1475031449641271, 0.3536988589337304,
            0.6307665754561753, 0.950786988894545, 1.279796896343255,
            1.581349858289131, 1.819900644526752, 1.964685516817988},
           {0.02861757715575863, 0.1470576708182392, 0.3532243803715354,
            0.6303706486715199, 0.9504872281809185, 1.279593281676231,
            1.58123243449105, 1.819850421529327, 1.964675703881051},
           {0.0284928148303627, 0.1466051318488109, 0.3527573759143641,
            0.6299826519530838, 0.9501931042099383, 1.279392985719347,
            1.581116590640441, 1.819800737526425, 1.964665976867012},
           {0.0283581626910121, 0.1461487978526468, 0.3523013451921377,
            0.6296062306765777, 0.9499082458865105, 1.279199089306691,
            1.581004424146684, 1.819752598158294, 1.964656545438364},
           {0.02821241121729634, 0.1456908682398006, 0.3518570235246861,
            0.6292412742620199, 0.9496322512404078, 1.279011169293512,
            1.580895648174286, 1.819705882066283, 1.964647387966653},
           {0.02805420197416741, 0.1452336355689576, 0.3514247950558063,
            0.6288872684143532, 0.9493643222672252, 1.278828434575292,
            1.580789651054809, 1.819660255776219, 1.964638427917517},
           {0.02788207631011397, 0.1447795843079509, 0.3510050608666022,
            0.6285438088380824, 0.9491037959913415, 1.278650246870005,
            1.580685998429957, 1.819615529075944, 1.964629630260402},
           {0.02769458424591731, 0.1443317236961392, 0.3505993468506867,
            0.6282125551047617, 0.9488526901292647, 1.278478634442679,
            1.580586247737601, 1.819572505901026, 1.964621168545431},
           {0.02749015723398252, 0.1438924258265915, 0.3502076232415075,
            0.6278925892614544, 0.9486096525094401, 1.2783122164354,
            1.580489367508039, 1.819530674904125, 1.964612935976349},
           {0.02726754176632573, 0.14346513759395, 0.3498326629197415,
            0.6275873828967928, 0.9483783596472084, 1.278154090175142,
            1.580397376320546, 1.819490950238345, 1.964605114595264},
           {0.02702496444815172, 0.1430494134388907, 0.3494698743691713,
            0.6272904189975195, 0.9481519016207944, 1.277998351887789,
            1.580306286351529, 1.819451437300087, 1.964597311867053},
           {0.02676166582883166, 0.1426474726054996, 0.3491211504441638,
            0.6270045782922282, 0.947933770697853, 1.277848388795754,
            1.580218671809311, 1.819413485286085, 1.96458982533605},
           {0.02647723969787408, 0.1422596977202102, 0.3487856245090701,
            0.6267289205375208, 0.947722992869285, 1.277703235831025,
            1.58013373358036, 1.819376637333675, 1.964582548370191},
           {0.02617218745781935, 0.1418859827182781, 0.3484627668222964,
            0.6264635403218843, 0.9475200914244231, 1.27756347558115,
            1.580051884987654, 1.819341092540487, 1.964575523256215},
           {0.02584795889735458, 0.141524030891385, 0.3481481837611182,
            0.6262031113920803, 0.9473198638635068, 1.277425011034479,
            1.579970580550566, 1.819305721377611, 1.964568524935804},
           {0.0255083216136518, 0.1411747435887705, 0.3478446833789048,
            0.6259523650847083, 0.9471276984501837, 1.277292539873133,
            1.57989299330922, 1.819272027974817, 1.96456186530623},
           {0.02515865622215152, 0.1408364442363022, 0.3475489855298892,
            0.6257069106036297, 0.9469388749468588, 1.277161973731861,
            1.579816346177987, 1.819238691126222, 1.964555270414234},
           {0.02480733765730747, 0.1405104354684845, 0.3472626514663586,
            0.6254687528785954, 0.9467555389845441, 1.277035154762084,
            1.579741860849906, 1.819206271929053, 1.964548853100844},
           {0.02446602891094551, 0.1402007385802111, 0.3469892561512087,
            0.6252407418675443, 0.9465796960791384, 1.276913351204976,
            1.579670241512358, 1.819175072803171, 1.964542673894802},
           {0.02414997545246145, 0.1399149217764395, 0.3467351452546859,
            0.625027886818371, 0.9464150421053286, 1.276799056487831,
            1.579602943547988, 1.819145731693054, 1.964536860297591},
           {0.02387870995231922, 0.1396680562652493, 0.3465155996706728,
            0.6248445112262901, 0.9462736739689779, 1.276701232330656,
            1.579545494260183, 1.819120734149754, 1.96453191317323},
           {0.02367475777864181, 0.1394787677804392, 0.3463462452121395,
            0.6247025163185129, 0.946163825859407, 1.276624941168976,
            1.579500517231165, 1.819101092762548, 1.964528016323514},
           {0.02356265853179052, 0.1393725772620758, 0.3462510727248738,
            0.6246227842186918, 0.9461022962699492, 1.276582393005307,
            1.57947557573968, 1.819090262535484, 1.964525876095157}};

  // Calculating the Wcoeff and Xcoeff matrices
  auto make_eps_power_vector = [&](double eps) {
    Eigen::VectorXd pows(k + 1);
    for (unsigned i = 0; i < k + 1; ++i) {
      pows(i) = std::pow(eps, i);
    }
    Eigen::VectorXd out(num_cheby_nodes);
    out << log(eps) * pows, pows;
    return out;
  };

  Eigen::MatrixXd lhs(num_cheby_nodes, num_cheby_nodes);
  for (unsigned j = 0; j < num_cheby_nodes; ++j)
    lhs.row(j) = make_eps_power_vector(epsilons[j]).transpose();

  Eigen::FullPivLU<Eigen::MatrixXd> dec(lhs);
  // Eigen::CompleteOrthogonalDecomposition<Eigen::MatrixXd> dec(lhs);
  for (unsigned i = 0; i < 9; ++i) {
    Eigen::VectorXd rhsW(num_cheby_nodes);
    Eigen::VectorXd rhsX(num_cheby_nodes);
    for (unsigned j = 0; j < num_cheby_nodes; ++j) {
      rhsW(j) = weights[j][i];
      rhsX(j) = nodes[j][i];
    }

    Wcoeffs.col(i) = dec.solve(rhsW);
    Xcoeffs.col(i) = dec.solve(rhsX);
  }
}

std::pair<Eigen::VectorXd, Eigen::VectorXd> getQuadrature(const double &eps) {
  initialize();
  // Vector to store Quadrature Nodes
  Eigen::VectorXd pts(9);
  // Vector to store the lagrangian polynomials
  Eigen::VectorXd polynomials(num_cheby_nodes);
  // Filling the polynomials vector
  for (unsigned i = 0; i < num_cheby_nodes; ++i) {
    double poly = 1.;
    for (unsigned j = 0; j < num_cheby_nodes; ++j) {
      if (j != i)
        poly *= (eps - epsilons[j]) / (epsilons[i] - epsilons[j]);
    }
    polynomials(i) = poly;
  }
  // Looping over all the quadrature nodes
  for (unsigned i = 0; i < 9; ++i) {
    double estimate = 0.;
    // Looping over all the polynomials
    for (unsigned j = 0; j < num_cheby_nodes; ++j)
      estimate += polynomials(j) * nodes[j][i]; // Lagrangian Interpolation
    pts(i) = estimate;
  }
  // Vector to store Quadrature Weights
  Eigen::VectorXd wts(9);
  // Looping over all the quadrature weights
  for (unsigned i = 0; i < 9; ++i) {
    double estimate = 0.;
    // Looping over all the polynomials
    for (unsigned j = 0; j < num_cheby_nodes; ++j)
      estimate += polynomials(j) * weights[j][i]; // Lagrangian Interpolation
    wts(i) = estimate;
  }
  return std::make_pair(pts, wts);
}

std::pair<Eigen::VectorXd, Eigen::VectorXd> getQuadrature2(const double &eps) {
  initialize();
  auto make_eps_power_vector = [&](double eps) {
    Eigen::VectorXd out2(k + 1);
    for (unsigned i = 0; i < k + 1; ++i) {
      out2(i) = std::pow(eps, i);
    }
    Eigen::VectorXd out1(k + 1);
    for (unsigned i = 0; i < k + 1; ++i) {
      out1(i) = std::pow(eps, i) * log(eps);
    }
    Eigen::VectorXd out(num_cheby_nodes);
    out << out1, out2;
    return out;
  };

  Eigen::VectorXd pts;
  Eigen::VectorXd wts;
  Eigen::VectorXd vec = make_eps_power_vector(eps);
  pts = vec.transpose() * Xcoeffs;
  wts = vec.transpose() * Wcoeffs;
  return std::make_pair(pts, wts);
}
